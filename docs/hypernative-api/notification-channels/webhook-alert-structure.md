# Webhook Message Structure

After you [configure your Webhook in the Hypernative Web Application](../../../hypernative-web-application/configure-external-alert-channels/webhook/overview.md) and connect it to a Watchlist or a Custom Agent, Hypernative will send POST messages to your Webhook's endpoint whenever an Alert occurs, with the following structure:

### Headers

`content-type: "application/json"`

You can configure to [send additional header names and values to your Webhooks](../../../hypernative-web-application/configure-external-alert-channels/webhook/overview.md).



### Attributes

<table><thead><tr><th width="166">Name</th><th width="150">Type</th><th>Description</th></tr></thead><tbody><tr><td>id</td><td>string</td><td>Unique ID for this Webhook message.</td></tr><tr><td>digitalSignature</td><td>string</td><td><p>Enables you to validate that this message originated from Hypernative. To validate, you create a hash of the <code>digitalSignature</code> attribute and the message, and then check that this hash matches Hypernative's public key. </p><p>For more, see <a href="webhook-message-validation.md">this page</a>.</p></td></tr><tr><td>data</td><td><a href="webhook-alert-structure.md#webhookdata-object">WebhookData Object </a>converted to string</td><td><p>The details of this Webhook message.</p><p>Note: This object is returned as a string to ensure that the other parameter, <code>digitalSignature</code>, has a hash of the object's attributes in the exact order they appear.</p><p>When you receive this object, you must convert the string into an object to extract its inner attributes. </p><ul><li>In JavaScript, you can use <code>JSON.parse(data)</code></li><li>In Python, you can use <code>json.loads(data)</code></li><li>In Java, you can use <code>ObjectMapper.readValue(data, Map.class)</code></li><li>In Go, you can use <code>json.Unmarshal([]byte(data), &#x26;parsedData)</code></li></ul></td></tr></tbody></table>



### WebhookData Object

Attributes:

|  Name                | Type                                                                                                   | Description                                                                                                                                                 |
| -------------------- | ------------------------------------------------------------------------------------------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------- |
| riskInsight          | [RiskInsightWebhookData Object](webhook-alert-structure.md#riskinsightwebhookdata-object)              | The associated Risk Insight data.                                                                                                                           |
| watchlists           | Array of [Watchlist](../watchlists/getwatchlist.md)                                                    | <p>The one or more Watchlists that triggered this Alert. </p><p>In case this Alert was not triggered by a Watchlist, an empty array is returned.</p>        |
| customAgents         | Array of [CustomAgent](../custom-agents/custom-agent-retrieval-by-id.md)                               | <p>The one or more Custom Agents that triggered this Alert. </p><p>In case this Alert was not triggered by a Custom Agent, an empty array is returned.</p>  |
| securitySuits        | Array of [SecuritySuit](../screener/address-reputation/screener-policies/get-screener-policy-by-id.md) | <p>The one or more Security Suits that triggered this Alert.</p><p>In case this Alert was not triggered by a Security Suit, an empty array is returned.</p> |
| triggeredAssets      | Array of [TriggeredAssetData Objects](webhook-alert-structure.md#triggeredassetdata-object)            | The one or more Assets, included in Watchlists, that triggered this Alert. In case this Alert was not triggered by a Watchlist, an empty array is returned. |
| context (deprecated) | Array of Objects                                                                                       | This attribute and its contents are not officially supported or maintained. Hypernative may delete or change the contents of this attribute at any time.    |



### RiskInsightWebhookData Object

Attributes:

| Name                | Type                                                                                       | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| ------------------- | ------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| id                  | string                                                                                     | The ID of this Risk Insight.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| chain               | string                                                                                     | The chain that created this Risk Insight. For the supported chain names, see [this page](../supported-chains/).                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| name                | string                                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| category            | enum                                                                                       | An Enum of `Security`, `Technical`, `Financial`, `Governance` or `Community`.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| status              | enum                                                                                       | An Enum of `Active` or `Historical`.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| timestamp           | string                                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| severity            | enum                                                                                       | An Enum of `Info`, `Low`, `Medium` or `High`.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| details             | string                                                                                     | The Risk Insight description.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| involvedAssets      | Array of [InvolvedAssetData Objects](webhook-alert-structure.md#involvedassetdata-object)  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| riskTypeId          | string                                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| riskTypeDescription | string                                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| txnHash             | string                                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| stage               | enum                                                                                       | <p>In case this Alert was generated by a Watchlist, or by one of the Custom Agents that sends an Alert per event, this attribute will be set to either <code>oneshot</code> or <code>undefined</code>.</p><p>In case this Alert was generated by a Custom Agent that sends State Alerts, this attribute will be set to either <code>Start</code>, <code>Reminder</code>, or <code>End</code>. </p><p>Read more about Frequency of Alerts at <a href="../../../hypernative-web-application/configure-external-alert-channels/configuring-channels.md#frequency-of-alerts">this page</a>.</p> |
| parentRiId          | nullable string                                                                            | <p>In case the attribute <code>stage</code> is set to <code>Reminder</code> or <code>End</code>, then this attribute is set to the ID of the Risk Insight that generated the <code>Start</code> stage. </p><p>Read more about Frequency of Alerts at <a href="../../../hypernative-web-application/configure-external-alert-channels/configuring-channels.md#frequency-of-alerts">this page</a>.</p>                                                                                                                                                                                        |
| threatIntelReview   | nullable enum                                                                              | <p>Available for selected customers only.  </p><p>The Hypernative Security Research Team manually investigates whether the Alerts that were sent and related to Security are of significant importance, and if so, they send a Webhook message with this attribute set to <code>Reviewed</code>. Otherwise, they send a Webhook message with this attribute set to <code>Dismissed</code>.</p>                                                                                                                                                                                              |



### TriggeredAssetData Object

Attributes:

| Name                          | Type            | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| ----------------------------- | --------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| chain                         | string          | The chain that this Asset belongs to. For the supported chain names, see [this page](../supported-chains/).                                                                                                                                                                                                                                                                                                                                                                                                                 |
| type                          | enum            | <p>Valid values:</p><p><code>Protocol</code> - represents a Protocol or a Bridge that Hypernative maps to list of addresses. Read more about Hypernative's Protocol and Bridge mapping <a href="../../../hypernative-web-application/bridges-monitoring.md">here</a>.</p><p><code>Contract</code> - represents a crypto address, that Hypernative detects that contains contract logics.</p><p><code>Wallet</code> - represents a crypto address, that Hypernative detects that does not contain smart contract logics.</p> |
| name                          | nullable string | <p>If <code>type</code> is set to <code>Protocol</code>, then the <code>name</code> presents the protocol or bridge name. </p><p>If <code>type</code> is set to <code>Contract</code> or <code>Wallet</code>, then the attribute is not returned.</p>                                                                                                                                                                                                                                                                       |
| address                       | nullable string | <p>If <code>type</code> is set to <code>Contract</code> or <code>Wallet</code>, then the <code>address</code> presents the address of this asset.<br>If <code>type</code> is set to <code>Protocol</code>, then the attribute is not returned.</p>                                                                                                                                                                                                                                                                          |
| alias                         | string          | The Asset's alias. For more information, see [this page](../../../hypernative-web-application/assets-context/asset-aliases-and-system-labels.md).                                                                                                                                                                                                                                                                                                                                                                           |
| watchlistName                 | string          | The name of the Watchlist that has this Asset and generated this Webhook's Alert.                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| involvementType               | string          | The purpose of this Asset in the Alert.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| addressConverted (deprecated) | string          | This attribute and its contents are not officially supported or maintained. Hypernative may delete or change the contents of this attribute at any time.                                                                                                                                                                                                                                                                                                                                                                    |
| systemLabelStr (deprecated)   | string          | This attribute and its contents are not officially supported or maintained. Hypernative may delete or change the contents of this attribute at any time.                                                                                                                                                                                                                                                                                                                                                                    |
| icon (deprecated)             | string          | This attribute and its contents are not officially supported or maintained. Hypernative may delete or change the contents of this attribute at any time.                                                                                                                                                                                                                                                                                                                                                                    |
| chainDisplayName (deprecated) | string          | This attribute and its contents are not officially supported or maintained. Hypernative may delete or change the contents of this attribute at any time.                                                                                                                                                                                                                                                                                                                                                                    |



### InvolvedAssetData Object&#x20;

| Name            | Type            | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| --------------- | --------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| chain           | string          | The chain that this Asset belongs to. For the supported chain names, see [this page](../supported-chains/).                                                                                                                                                                                                                                                                                                                                                                                                                 |
| type            | enum            | <p>Valid values:</p><p><code>Protocol</code> - represents a Protocol or a Bridge that Hypernative maps to list of addresses. Read more about Hypernative's Protocol and Bridge mapping <a href="../../../hypernative-web-application/bridges-monitoring.md">here</a>.</p><p><code>Contract</code> - represents a crypto address, that Hypernative detects that contains contract logics.</p><p><code>Wallet</code> - represents a crypto address, that Hypernative detects that does not contain smart contract logics.</p> |
| name            | nullable string | <p>If <code>type</code> is set to <code>Protocol</code>, then the <code>name</code> presents the protocol or bridge name. </p><p>If <code>type</code> is set to <code>Contract</code> or <code>Wallet</code>, then the attribute is not returned.</p>                                                                                                                                                                                                                                                                       |
| address         | nullable string | <p>If <code>type</code> is set to <code>Contract</code> or <code>Wallet</code>, then the <code>address</code> presents the address of this asset.<br>If <code>type</code> is set to <code>Protocol</code>, then the attribute is not returned.</p>                                                                                                                                                                                                                                                                          |
| alias           | string          | The Asset's alias. For more information, see [this page](../../../hypernative-web-application/assets-context/asset-aliases-and-system-labels.md).                                                                                                                                                                                                                                                                                                                                                                           |
| involvementType | string          | The purpose of this Asset in the Alert.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |



### Example Webhook

Note: The `data` attribute is returned as a string, to ensure that the other attribute, `digitalSignature`, has a hash of the webhook's attributes in the exact order they appear.

When you receive this Webhook, you must convert the `data` into an object to extract its inner attributes.&#x20;

* In JavaScript, you can use `JSON.parse(data)`
* In Python, you can use `json.loads(data)`
* In Java, you can use `ObjectMapper.readValue(data, Map.class)`
* In Go, you can use `json.Unmarshal([]byte(data), &parsedData)`

Example of Alert with a Watchlist:&#x20;

```json
{
  "id": "04c57ee4-08d9-4df8-bfb3-656700479783",
  "data": "{\"riskInsight\":{\"id\":\"NR5M1VFJVXVR\",\"chain\":\"ethereum\",\"name\":\"Sending funds to a mixer\",\"category\":\"Security\",\"status\":\"Active\",\"timestamp\":\"2024-05-19T12:18:35.000Z\",\"severity\":\"Medium\",\"details\":\"1 ETH ($3.1K) sent by address <0xac1a5dfcc49cd978d437b619b0cf0e339873e6fe|0xac1a5dfcc49cd978d437b619b0cf0e339873e6fe> to mixer <Tornado.Cash: 1 ETH|0x47ce0c6ed5b0ce3d3a51fdb1c52dc66a7c3c2936>\",\"involvedAssets\":[{\"address\":\"0x47ce0c6ed5b0ce3d3a51fdb1c52dc66a7c3c2936\",\"alias\":\"Tornado.Cash: 1 ETH\",\"type\":\"Contract\",\"chain\":\"ethereum\",\"involvementType\":\"Mixer\"},{\"address\":\"0xd90e2f925da726b50c4ed8d0fb90ad053324f31b\",\"alias\":\"Tornado.Cash: Router\",\"type\":\"Contract\",\"chain\":\"ethereum\",\"involvementType\":\"Mixer\"},{\"address\":\"0xac1a5dfcc49cd978d437b619b0cf0e339873e6fe\",\"type\":\"Wallet\",\"chain\":\"ethereum\",\"involvementType\":\"Sender\"},{\"name\":\"Tornado core\",\"type\":\"Protocol\",\"chain\":\"ethereum\",\"involvementType\":\"Protocol, Mixer\"}],\"riskTypeId\":\"A-3902\",\"riskTypeDescription\":\"The address sent funds to a mixer (such as Tornado Cash)\",\"txnHash\":\"0x7fdb1e7f5053dccb9950638dffa3cf51ae4182baaf124de49ce9b74dc0ac6769\",\"stage\":\"Undefined\",\"parentRiId\":\"NR5M1VFJVXVR\",\"threatIntelReview\":\"NotReviewed\"},\"watchlists\":[{\"id\":709,\"name\":\"involvement type test\",\"description\":\"\",\"createdAt\":\"2023-05-02T10:49:20.403Z\",\"updatedAt\":\"2023-12-10T08:47:47.648Z\",\"createdBy\":\"Ronen Badalov\",\"createdByUserId\":13,\"assets\":[{\"chain\":\"ethereum\",\"address\":null,\"name\":\"Tornado core\",\"type\":\"Protocol\"},{\"chain\":\"ethereum\",\"address\":null,\"name\":\"Hundred Finance core\",\"type\":\"Protocol\"},{\"chain\":\"bsc\",\"address\":\"0x0000000000000000000000000000000000000000\",\"name\":null,\"type\":\"Contract\"}],\"alertsTagsStats\":[{\"count\":0,\"name\":\"All\"},{\"count\":0,\"name\":\"Read\"},{\"count\":0,\"name\":\"Unread\"},{\"count\":0,\"name\":\"Important\"},{\"count\":0,\"name\":\"Dismissed\"}]}],\"customAgents\":[],\"triggeredAssets\":[{\"chain\":\"ethereum\",\"address\":null,\"name\":\"Tornado core\",\"type\":\"Protocol\"}],\"securitySuits\":[]}",
  "digitalSignature": "MEQCIAF+UdE6hQxQ53FPiltOHp+Lh8AAKhdAceD8u3DaXNMEAiAW/ugNdh4Gx0LIfXQJ88Hz9pVizNUxTpb6FrkNxkAg7A=="
}
```

Example of Alert with a Custom Agent:

```json
{
  "id": "87ca3ab4-549d-4d5a-bc1e-df3e5665348f",
  "data": "{\n    \"riskInsight\": {\n        \"id\": \"4BL322TJFP4O\",\n        \"chain\": \"ethereum\",\n        \"name\": \"[C] Message detected\",\n        \"category\": \"Technical\",\n        \"status\": \"Active\",\n        \"timestamp\": \"2024-05-19T08:57:59.000Z\",\n        \"severity\": \"Medium\",\n        \"details\": \"Message from <0xf58f662aac9643de31822e9155d31124bd2bdbe6|0xf58f662aac9643de31822e9155d31124bd2bdbe6> to <N (N)|0xe73d53e3a982ab2750a0b76f9012e18b256cc243>: \\u0012Iŋ \",\n        \"involvedAssets\": [\n            {\n                \"address\": \"0xe73d53e3a982ab2750a0b76f9012e18b256cc243\",\n                \"alias\": \"N (N)\",\n                \"type\": \"Contract\",\n                \"chain\": \"ethereum\",\n                \"involvementType\": \"Destination\"\n            },\n            {\n                \"address\": \"0xf58f662aac9643de31822e9155d31124bd2bdbe6\",\n                \"type\": \"Wallet\",\n                \"chain\": \"ethereum\",\n                \"involvementType\": \"Origin\"\n            }\n        ],\n        \"riskTypeId\": \"C-19291\",\n        \"riskTypeDescription\": \"An on-chain message detected, matching user-defined params\",\n        \"txnHash\": \"0x7093f73c2bde1e203bd70f2432aac1319e3138e7146684a48557e91960b1d34d\",\n        \"stage\": \"Undefined\",\n        \"parentRiId\": \"4BL322TJFP4O\",\n        \"threatIntelReview\": \"NotReviewed\"\n    },\n    \"watchlists\": [],\n    \"customAgents\": [\n        {\n            \"id\": 1000867,\n            \"agentName\": \"ALERT BOMB\",\n            \"agentType\": \"onChainMessageMonitor\",\n            \"severity\": \"Medium\",\n            \"muteDuration\": 0,\n            \"delay\": 600,\n            \"rule\": {\n                \"chain\": \"all_evm_chains\",\n                \"nameRegex\": \".*\",\n                \"ruleString\": \"On all evm chains: when an on-chain message detected, matching .* sent from and to any eoa\",\n                \"isReminderEnabled\": false,\n                \"monitoredToAddresses\": [],\n                \"monitoredFromAddresses\": []\n            },\n            \"createdAt\": \"2024-05-06T12:12:09.939Z\",\n            \"updatedAt\": \"2024-05-19T08:56:24.937Z\",\n            \"state\": \"enabled\",\n            \"createdBy\": \"Ronen Badalov\",\n            \"createdByUserId\": 13,\n            \"alertsTagsStats\": [\n                {\n                    \"count\": 0,\n                    \"name\": \"All\"\n                },\n                {\n                    \"count\": 0,\n                    \"name\": \"Read\"\n                },\n                {\n                    \"count\": 0,\n                    \"name\": \"Unread\"\n                },\n                {\n                    \"count\": 0,\n                    \"name\": \"Important\"\n                },\n                {\n                    \"count\": 0,\n                    \"name\": \"Dismissed\"\n                }\n            ]\n        }\n    ],\n    \"triggeredAssets\": [],\n    \"securitySuits\": []\n}",
  "digitalSignature": "MEYCIQDQFhusXNIZgJl8ALHs0zjSDTCp1cQfohWFm/SqDQHTFgIhAI80+jpHuVuAOiH0Zth5Z6BERVTbaVx3aKkis19ws3u/"
}
```
